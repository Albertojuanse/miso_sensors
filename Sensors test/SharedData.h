//
//  SharedData.h
//  Sensors test
//
//  Created by Alberto J. on 24/6/19.
//  Copyright Â© 2019 MISO. All rights reserved.
//

#import <Foundation/Foundation.h>
#import "RDPosition.h"
#import "MDType.h"

/*!
 @class SharedData
 @discussion This class works as a monitor for all the aplication shared data such as locations or measures.
 */
@interface SharedData: NSObject {
    
    // Colections of data
    NSMutableArray * sessionData;    // Set of dictionaries with the information generated by the user in each use
    NSMutableArray * itemsData;      // Set of dictionaries with the information of every position, beacon... submitted by the user
    NSMutableArray * measuresData;   // Set of dictionaries with the measures taken
    NSMutableArray * locationsData;  // Set of dictionaries with the positions locted in space using location methods
    NSMutableArray * metamodelData;  // Set of dictionaries with the metamodeling types
    NSMutableArray * modelData;      // Set of dictionaries with the models generated or imported
    
    
    // Identifiers generation variables
    NSNumber * sessionIdNumber;
    NSNumber * itemsIdNumber;
    NSNumber * measureIdNumber;
    NSNumber * locationsIdNumber;
    NSNumber * metamodelIdNumber;
    NSNumber * modelIdNumber;
    
    // Declare the inner dictionaries; they will be created or gotten if they already exists each use
    NSMutableDictionary * sessionDic;
    NSMutableDictionary * userDic;
    NSMutableDictionary * itemDic;
    NSMutableDictionary * positionDic;
    NSMutableDictionary * uuidDic;
    NSMutableDictionary * measureDic;
    NSMutableDictionary * locationDic;
    NSMutableDictionary * modelDic;
    
}

// General methods
- (void) reset;

// General getters
- (NSMutableArray *)getSessionData;
- (NSMutableArray *)getItemsData;
- (NSMutableArray *)getMeasuresData;
- (NSMutableArray *)getLocationsData;
- (NSMutableArray *)getMetamodelData;
- (NSMutableArray *)getModelData;

// Specific getters
- (NSMutableDictionary *)fromSessionDataGetKey:(NSString *)key;
- (NSMutableDictionary *)fromSessionDataGetUserDic;
- (NSString *)fromSessionDataGetMode;
- (NSString *)fromSessionDataGetItemChosenByUser;
- (NSString *)fromSessionDataGetTypeChosenByUser;

- (NSMutableArray *)fromItemDataGetItems;

- (NSMutableArray *)fromMeasuresDataGetMeasures;
- (NSMutableArray *)fromMeasuresDataGetPositions;
- (NSMutableArray *)fromMeasuresDataGetSourceUUIDs;
- (NSMutableArray *)fromMeasuresDataGetTargetUUIDs;
- (NSMutableArray *)fromMeasuresDataGetMeasuresTakenFromPosition:(RDPosition*)position;
- (NSMutableArray *)fromMeasuresDataGetMeasuresTakenFromSourceUUID:(NSString*)uuid;
- (NSMutableArray *)fromMeasuresDataGetMeasuresTakenFromTargetUUID:(NSString*)uuid;
- (NSMutableArray *)fromMeasuresDataGetMeasuresTakenFromPosition:(RDPosition*)position
                                                   andSourceUUID:(NSString*)uuid;
- (NSMutableArray *)fromMeasuresDataGetMeasuresTakenFromPosition:(RDPosition*)position
                                                   andTargetUUID:(NSString*)uuid;
- (NSNumber *)fromMeasuresDataGetMaxMeasureOfType:(NSString *)type;

- (NSMutableArray *)fromLocationsDataGetPositions;

- (NSMutableArray *)fromMetamodelDataGetTypes;

- (NSMutableArray *)fromModelDataGetModels;

// Specific setters
- (void) inSessionDataSetVariable:(id)variable;

- (void) inItemDataSetItem:(NSMutableDictionary*)item;

- (void) inMeasuresDataSetMeasure:(NSNumber*)measure
                           ofType:(NSString*)type
                   withSourceUUID:(NSString*)uuid
                       atPosition:(RDPosition*)positionp;
- (void) inMeasuresDataSetMeasure:(NSNumber*)measure
                           ofType:(NSString*)type
                   withTargetUUID:(NSString*)uuid
                       atPosition:(RDPosition*)positionp;

- (void) inLocationsDataSetPosition:(RDPosition*)position
                           fromUUID:(NSString*)locatedUUID;
- (void) inLocationsDataSetPosition:(RDPosition*)position
                             ofUUID:(NSString*)locatedUUID;

- (void) inMetamodelDataSetType:(MDType*)type;

- (void) inModelDataSetModel:(NSMutableDictionary*)model;

@end
